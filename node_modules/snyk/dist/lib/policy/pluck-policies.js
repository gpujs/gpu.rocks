"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.pluckPolicies = void 0;
const _ = require("@snyk/lodash");
function pluckPolicies(pkg) {
    if (!pkg) {
        return null;
    }
    if (pkg.snyk) {
        return pkg.snyk;
    }
    if (!pkg.dependencies) {
        return null;
    }
    return _.flatten(Object.keys(pkg.dependencies)
        .map((name) => {
        return pluckPolicies(pkg.dependencies[name]);
    })
        .filter(Boolean));
}
exports.pluckPolicies = pluckPolicies;
//# sourceMappingURL=pluck-policies.js.map